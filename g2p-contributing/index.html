<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" href="https://blog.mothertongues.org/assets/images/logo_no_text.png">

    <title>G2P Part 7: Contributing a new mapping to g2p for everyone to use | Mother Tongues Blog</title>

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="G2P Part 7: Contributing a new mapping to g2p for everyone to use" />
<meta name="author" content="AidanPine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tutorial: Contributing a new mapping to g2p for everyone to use" />
<meta property="og:description" content="Tutorial: Contributing a new mapping to g2p for everyone to use" />
<link rel="canonical" href="https://blog.mothertongues.org/g2p-contributing/" />
<meta property="og:url" content="https://blog.mothertongues.org/g2p-contributing/" />
<meta property="og:site_name" content="Mother Tongues Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-10-27T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@AidanPine" />
<meta name="twitter:creator" content="@AidanPine" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"AidanPine"},"description":"Tutorial: Contributing a new mapping to g2p for everyone to use","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.mothertongues.org/g2p-contributing/"},"@type":"BlogPosting","url":"https://blog.mothertongues.org/g2p-contributing/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://blog.mothertongues.org/assets/images/logo_no_text.png"},"name":"AidanPine"},"headline":"G2P Part 7: Contributing a new mapping to g2p for everyone to use","dateModified":"2021-10-27T00:00:00+00:00","datePublished":"2021-10-27T00:00:00+00:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link href="/assets/css/screen.css" rel="stylesheet">

    <link href="/assets/css/main.css" rel="stylesheet">

    <link href="https://unpkg.com/applause-button/dist/applause-button.css" rel="stylesheet">

    <script src="/assets/js/jquery.min.js"></script>

    <script src="/assets/js/readingtime.min.js"></script>

    <script src="https://unpkg.com/applause-button/dist/applause-button.js"></script>

    <script>
        $(function () {
            $('.article-post').readingTime({
                readingTimeAsNumber: false,
                readingTimeTarget: $('.reading-time'),
                wordsPerMinute: 150,
                prependTimeString: "Read time: ",
                round: true,
                lang: 'en',
                success: function (data) {
                    console.log(data);
                },
                error: function (data) {
                    console.log(data.error);
                    $('.reading-time').remove();
                }
            });
        })
    </script>

</head>


<!-- change your GA id in _config.yml -->
<script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-100872710-18', 'auto');
    ga('send', 'pageview');
</script>




<body class="layout-post">
    <!-- defer loading of font and font awesome -->
    <noscript id="deferred-styles">
        <link
            href="https://fonts.googleapis.com/css?family=Amatic+SC%7CRighteous%7CMerriweather:300,300i,400,400i,700,700i"
            rel="stylesheet">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
            integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    </noscript>


    <!-- Begin Menu Navigation
================================================== -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

        <div class="container pr-0">

            <!-- Begin Logo -->
            <a class="navbar-brand" href="/">
                <img src="/assets/images/logo_no_text.png" alt="Mother Tongues Blog"> Mother Tongues
            </a>
            <!-- End Logo -->

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarMediumish">

                <!-- Begin Menu -->

                <ul class="navbar-nav ml-auto">

                    
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/index.html">Blog</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="https://blog.mothertongues.org/about">About</a>
                    </li>

                    <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

                </ul>

                <!-- End Menu -->

            </div>

        </div>
    </nav>
    <!-- End Navigation
================================================== -->

    <div class="site-content">

        <div class="container">

            <!-- Site Title
================================================== -->
            <div class="mainheading">
                <h1 class="sitetitle">Mother Tongues Blog</h1>
                <p class="lead">
                    Smashing the lore of language technology!
                </p>
            </div>

            <!-- Content
================================================== -->
            <div class="main-content">
                <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=G2P Part 7: Contributing a new mapping to g2p for everyone to use&url=https://blog.mothertongues.org/g2p-contributing/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=https://blog.mothertongues.org/g2p-contributing/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://blog.mothertongues.org/g2p-contributing/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb"
                            src="https://www.gravatar.com/avatar/7623fd3eeb0acbe1084fecc20c3093ae?s=250&d=mm&r=x"
                            alt="Aidan">
                        
                    </div>
                    <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                        <a target="_blank" class="link-dark" href="https://aidanpine.ca">Aidan</a><a
                            target="_blank" href="https://twitter.com/aidanpine" class="btn follow">Follow</a>
                        <span class="author-description">Lead developer of Mother Tongues.</span>
                    </div>
                </div>
                

                <!-- Post Title -->
                <h1 class="posttitle">G2P Part 7: Contributing a new mapping to g2p for everyone to use</h1>
                <div class="eta reading-time" style='font-size: small;'>
                </div>
            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <p>This is the last part of the seven-part series on g2p. In this part, we’ll discuss how to contribute your mappings to the main g2p library.</p>

<h3 id="g2p-blog-series-index">G2P Blog Series Index</h3>

<ul>
  <li><a href="https://blog.mothertongues.org/g2p-background">Background</a></li>
  <li><a href="https://blog.mothertongues.org/g2p-basic-mappings-gui">How to write a basic mapping in G2P Studio</a></li>
  <li><a href="https://blog.mothertongues.org/g2p-basic-mappings-local">Writing mappings on your computer</a></li>
  <li><a href="https://blog.mothertongues.org/g2p-advanced-mappings">Advanced mappings</a></li>
  <li><a href="https://blog.mothertongues.org/g2p-applications">ReadAlong Studio &amp; Other Applications</a></li>
  <li><a href="https://blog.mothertongues.org/g2p-preprocess">Preprocessing mappings</a></li>
  <li>Contributing</li>
</ul>

<h2 id="advanced-contributing-your-rules-to-the-main-g2p-library">Advanced: contributing your rules to the main <code class="highlighter-rouge">g2p</code> library</h2>

<p>So, you’ve written some cool rules and you want to contribute, that’s awesome! There are lots of benefits to contributing your mapping to <code class="highlighter-rouge">g2p</code>. First of all, once your mapping is accepted, you’ll have it available and live on <a href="https://g2p-studio.herokuapp.com">G2P Studio</a>. Second, once the next version of <code class="highlighter-rouge">g2p</code> is released with your mapping, it will be automatically built in to the <a href="https://blog.mothertongues.org/convertextract-app">Convertextract</a> library. Third, if your mapping is between a language’s writing system and the IPA, you can also get <a href="https://blog.mothertongues.org/g2p-applications">ReadAlongs</a> support for your language.</p>

<p>So, you write your mapping once, and you get three things for free (G2P studio, convertextract and readalongs). Here’s how:</p>

<ol>
  <li>Fork g2p, see <a href="https://docs.github.com/en/github/getting-started-with-github/fork-a-repo">https://docs.github.com/en/github/getting-started-with-github/fork-a-repo</a> for more details</li>
  <li>Add a folder for your language using the appropriate <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-3_codes">ISO 639.3 code</a> to <code class="highlighter-rouge">g2p/mappings/langs</code>, i.e., create the folder <code class="highlighter-rouge">g2p/mapping/langs/&lt;yourlangcode&gt;/</code></li>
  <li>Add a <code class="highlighter-rouge">config.yaml</code> file as described <a href="https://blog.mothertongues.org/g2p-basic-mappings">here</a> in that folder</li>
  <li>Add your mapping in that same folder</li>
  <li>If your mapping is for an IPA mapping, you can optionally run <code class="highlighter-rouge">g2p update</code> to update your mapping into <code class="highlighter-rouge">g2p</code> and then generate the mapping as described in the <a href="https://blog.mothertongues.org/g2p-applications">ReadAlongs post</a> between your language and English IPA.</li>
  <li>Run <code class="highlighter-rouge">g2p update</code> to add your mapping to <code class="highlighter-rouge">g2p</code></li>
  <li>Add some test data to <code class="highlighter-rouge">g2p/tests/public/data</code>.</li>
  <li>Submit your changes by creating a <a href="https://github.com/roedoejet/g2p/compare">pull request</a></li>
</ol>

<p>Finally, either myself, or somebody else will review the changes, and you will get credit for those mappings and be added to the <a href="https://github.com/roedoejet/g2p/graphs/contributors">list of contributors</a></p>

<h3 id="adding-tests">Adding tests</h3>

<p>Testing your work is a really important part of software engineering. It lets us make changes to code and be confident that new features don’t break the expected functionality of <code class="highlighter-rouge">g2p</code>. In order to add tests for your mapping, you can add a CSV/TSV/PSV file with 4 columns to <code class="highlighter-rouge">g2p/tests/public/data</code>. The name of the file should be just the input language code, for example <code class="highlighter-rouge">fra.psv</code> for the French tests. The first column in the file is for the input language code, the second is for the output language code, the third is for the input text and the fourth is for the expected output of that mapping and input. Here is an example between French (fra) and French IPA (fra-ipa) asserting that ‘manger’ results in ‘mɑ̃ʒe’:</p>

<pre><code class="language-psv">fra|fra-ipa|manger|mɑ̃ʒe
fra|fra-ipa|écoutons|ekutɔ̃
</code></pre>

<p>There is a script for running tests at the root of the <code class="highlighter-rouge">g2p</code> project called <code class="highlighter-rouge">run_tests.py</code>. You can run all of the tests here using the following:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">python</span> <span class="n">run_tests</span><span class="o">.</span><span class="n">py</span> <span class="nb">all</span>
</code></pre></div></div>

<p>or just run the language assertions including your tests like shown above using:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">python</span> <span class="n">run_tests</span><span class="o">.</span><span class="n">py</span> <span class="n">langs</span>
</code></pre></div></div>

<p>Writing g2p mappings that handle all the special cases can be quite tricky, especially when there are potential interactions between rules. To be confident that your g2p mappings work as you think, you should add a bunch of different words covering most of the spelling phenomena of the language you’re working on, with their expected IPA mapping. Ideally, you should also add some test cases to eng-ipa and eng-arpabet, to make sure the generated mapping works correctly. If you run into difficulties, feel free to post comments on this blog post or on the g2p library GitHub issues page!</p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
                <small>
                    <span class="post-date"><time class="post-date"
                            datetime="2021-10-27">27 Oct 2021</time></span>
                    
                </small>
            </p>

            <!-- Claps -->
            <div class="mb-4 d-flex align-items-center" style='margin-top: 40px;'>
                <applause-button style="width: 58px; height: 58px;" />
            </div>
            <!-- End Claps -->

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                    <li>
                        <a data-proofer-ignore class="smoothscroll"
                            href="/tags#explanation">#explanation</a>
                    </li>
                    
                    <li>
                        <a data-proofer-ignore class="smoothscroll"
                            href="/tags#g2p">#g2p</a>
                    </li>
                    
                    <li>
                        <a data-proofer-ignore class="smoothscroll"
                            href="/tags#tech-showcase">#tech-showcase</a>
                    </li>
                    
                    <li>
                        <a data-proofer-ignore class="smoothscroll"
                            href="/tags#tutorial">#tutorial</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                
                <a class="prev d-block col-md-6" href="https://blog.mothertongues.org/g2p-preprocess/"> &laquo;
                    G2P Part 6: Solve inconsistencies in your text with a g2p pre-processing mapping</a>
                
                
                <a class="next d-block col-md-6 text-lg-right"
                    href="https://blog.mothertongues.org/g2p-case-feeding/">Preventing feeding of g2p rules with case &raquo; </a>
                
                <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->

<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">
            <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'mothertongues'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

        </div>
    </div>
</div>

<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

            </div>

            
            <!-- Bottom Alert Bar
================================================== -->
            <div class="alertbar">
                <div class="container text-center">
                    <span><img src="/assets/images/logo_no_text.png" alt="Mother Tongues Blog"> &nbsp; Never miss a
                        <b>story</b> from us, subscribe to our newsletter</span>
                    <form action="https://mailchi.mp/b87b1fbde236/mothertongues" method="post" name="mc-embedded-subscribe-form"
                        class="wj-contact-form validate" target="_blank" novalidate>
                        <div class="mc-field-group">
                            <input type="email" placeholder="Email" name="EMAIL" class="required email" id="mce-EMAIL"
                                autocomplete="on" required>
                            <input type="submit" value="Subscribe" name="subscribe" class="heart">
                        </div>
                    </form>
                </div>
            </div>
            

        </div>

        <!-- Categories Jumbotron
================================================== -->
        <div class="jumbotron fortags">
            <div class="d-md-flex h-100">
                <div class="col-md-4 transpdark align-self-center text-center h-100">
                    <div class="d-md-flex align-items-center justify-content-center h-100">
                        <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span
                                class="d-none d-md-inline">→</span></h2>
                    </div>
                </div>
                <div class="col-md-8 p-5 align-self-center text-center">
                    
                    
                    
                    <a data-proofer-ignore class="mt-1 mb-1"
                        href="/categories#tutorial">Tutorial
                        (7)</a>
                    
                    <a data-proofer-ignore class="mt-1 mb-1"
                        href="/categories#blog">Blog
                        (5)</a>
                    
                    
                    
                </div>
            </div>
        </div>

        <!-- Begin Footer
================================================== -->
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-sm-6 text-center text-lg-left">
                        Copyright © 2023 Mother Tongues
                    </div>
                </div>
            </div>
        </footer>
        <!-- End Footer
================================================== -->

    </div> <!-- /.site-content -->

    <!-- Scripts
================================================== -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>

    <script src="/assets/js/mediumish.js"></script>

    

    <script src="/assets/js/ie10-viewport-bug-workaround.js"></script>

    
    <script id="dsq-count-scr" src="//mothertongues.disqus.com/count.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
    <script>
       anchors.add();
    </script>
    

</body>

</html>
